%
% paper.ps
%
% Generates a sheet of paper for doing copperplate calligraphy
% practice on.
%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Units of measurement

/pt { 1 mul } def
/in { 72 mul } def
/mm { 72 mul 25.4 div } def

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Configurable constants

% Paper size. We'll print to the edge of the paper, and let the
% printer crop the margins it needs.
/pageheight 297 mm def
/pagewidth 210 mm def

% Heights of the components of the lines.
/baseheight 0.25 in def
/ascenderheight baseheight 2 mul def
/descenderheight ascenderheight def
/gap 0.1 in def

% Gap between the diagonal guide lines.
/xgap 0.5 in def

% Y offset to start at, given printers can't print all the way to the
% edge of the paper, so we can choose a margin size.
/yoffset gap def
% Ditto for X offset
/xoffset gap def

% Width of the lines
/lineweight 0.5 pt def

% Angle of the guide lines
/guideangle 55 def

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% And the actual implementation

/fullheight descenderheight baseheight ascenderheight add add def

% Find the number of repeated staves we need to do...
/yrepeats
    pageheight gap sub
    fullheight gap add
    div
    cvi 1 add
def

% and the number of italic lines per stave.
/xrepeats
    pagewidth xoffset sub xgap div cvi 1 add
def

% Draw a diagonal guide line
/italicline {
    currentpoint
    fullheight guideangle cos mul fullheight rlineto
    moveto
} def

% Draw a line and move up the given amount
/crossline {
    currentpoint
    pagewidth 0 rlineto
    3 2 roll add % Add the parameter to the Y coordinate
    moveto
} def


% Draw one "stave"
/stave {
    descenderheight crossline
    baseheight crossline
    ascenderheight crossline
    gap crossline
} def

newpath
    lineweight setlinewidth
    0 yoffset moveto
    yrepeats {
        currentpoint
        xoffset 0 rmoveto
        xrepeats {
            italicline
            xgap 0 rmoveto
        } repeat
        moveto
        stave
    } repeat
stroke
showpage
