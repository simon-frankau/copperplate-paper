%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 0 596 842
%%Title: (Calligraphy Practice Sheet)
%%Creator: (Simon Frankau)
%%CreationDate: (2017-04-30)
%%EndComments

%
% paper.ps
%
% Generates a sheet of paper for doing copperplate calligraphy
% practice on.
%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Units of measurement

/pt { 1 mul } def
/in { 72 mul } def
/mm { 72 mul 25.4 div } def

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Configurable constants

% Paper size. We'll print to the edge of the paper, and let the
% printer crop the margins it needs.
/PageHeight 297 mm def
/PageWidth 210 mm def

% Heights of the components of the lines.
/BaseHeight 0.25 in def
/AscenderHeight BaseHeight 2 mul def
/DescenderHeight AscenderHeight def
/Gap 0.1 in def

% Gap between the diagonal guide lines.
/XGap 0.5 in def

%Offsets around the edge of the page
/TopMargin Gap def
/BottomMargin Gap def
/LeftMargin Gap def
/RightMargin Gap def

% Width of the lines
/LineWeight 0.5 pt def

% Angle of the guide lines
/GuideAngle 55 def

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% And the actual implementation

/FullHeight DescenderHeight BaseHeight AscenderHeight add add def

/MarginHeight PageHeight TopMargin sub BottomMargin sub def
/MarginWidth PageWidth LeftMargin sub RightMargin sub def

/ItalicWidth FullHeight GuideAngle cos mul def

% Find the number of repeated staves we need to do...
/YRepeats
    MarginHeight FullHeight Gap add div cvi
def

% and the number of italic lines per stave.
/XRepeats
    MarginWidth ItalicWidth sub XGap div cvi
    1 add % Avoid fencepost error
def

% Centre the diagonal strokes
/XOffset
    MarginWidth
    XRepeats 1 sub XGap mul ItalicWidth add % Width of space used
    sub 2 div % And calculate the margin to put on each side
def

% Draw a diagonal guide line
/ItalicLine {
    currentpoint
    ItalicWidth FullHeight rlineto
    moveto
} def

% Draw a line and move up the given amount
/HorizontalLine {
    currentpoint
    MarginWidth 0 rlineto
    3 2 roll add % Add the parameter to the Y coordinate
    moveto
} def

% Draw one "stave"
/Stave {
    DescenderHeight HorizontalLine
    BaseHeight HorizontalLine
    AscenderHeight HorizontalLine
    Gap HorizontalLine
} def

newpath
    LineWeight setlinewidth
    LeftMargin BottomMargin moveto
    YRepeats {
        currentpoint
        XOffset 0 rmoveto
        XRepeats {
            ItalicLine
            XGap 0 rmoveto
        } repeat
        moveto
        Stave
    } repeat
stroke
showpage

%%EOF
