%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 0 0 596 842
%%Title: (Calligraphy Practice Sheet)
%%Creator: (Simon Frankau)
%%CreationDate: (2017-04-30)
%%EndComments

%
% paper.ps
%
% Generates a sheet of paper for doing copperplate calligraphy
% practice on.
%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Units of measurement

/pt { 1 mul } def
/in { 72 mul } def
/mm { 72 mul 25.4 div } def

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Configurable constants

% Paper size. We'll print to the edge of the paper, and let the
% printer crop the margins it needs.
/PageHeight 297 mm def
/PageWidth 210 mm def

% Heights of the components of the lines.
/BaseHeight 0.25 in def
/AscenderHeight BaseHeight 2 mul def
/DescenderHeight AscenderHeight def
/Gap 0.1 in def

% Gap between the diagonal guide lines.
/XGap 0.5 in def

% Y offset to start at, given printers can't print all the way to the
% edge of the paper, so we can choose a margin size.
/BottomMargin Gap def
% Ditto for X offset
/LeftMargin Gap def

% Width of the lines
/LineWeight 0.5 pt def

% Angle of the guide lines
/GuideAngle 55 def

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% And the actual implementation

/FullHeight DescenderHeight BaseHeight AscenderHeight add add def

% Find the number of repeated staves we need to do...
/YRepeats
    PageHeight Gap sub
    FullHeight Gap add
    div
    cvi
def

% and the number of italic lines per stave.
/XRepeats
    PageWidth LeftMargin sub XGap div cvi
def

% Draw a diagonal guide line
/ItalicLine {
    currentpoint
    FullHeight GuideAngle cos mul FullHeight rlineto
    moveto
} def

% Draw a line and move up the given amount
/HorizontalLine {
    currentpoint
    PageWidth 0 rlineto
    3 2 roll add % Add the parameter to the Y coordinate
    moveto
} def

% Draw one "stave"
/Stave {
    DescenderHeight HorizontalLine
    BaseHeight HorizontalLine
    AscenderHeight HorizontalLine
    Gap HorizontalLine
} def

newpath
    LineWeight setlinewidth
    0 BottomMargin moveto
    YRepeats {
        currentpoint
        LeftMargin 0 rmoveto
        XRepeats {
            ItalicLine
            XGap 0 rmoveto
        } repeat
        moveto
        Stave
    } repeat
stroke
showpage

%%EOF
